
library(phylobase)
library(ape)
library(phytools)
library(philr)

#read Zanne et al tree
mytree <- read.nexus("Angiosperm_MEDUSA_tree.nex")


sister_list <- 0
for(i in c(10939,11033,9987,14865,15516,8853,12263,12352,9531,8918,11540,12586,7918,8873,7869,8771,11197,15659,13526,12913,11705,9720,13953,11121,10988,12322,13282,14039,8711,8221,10865,15379,11006,12861,12692,13431,11718,9588,12979,7893,15380,11899,14321,11453,14500,13255,11561,14784,9382,14936,8152,15281,12843,12412,8385,12869,11144,9912,11519,12949,8950,10791,8656,12614,14235,9038,12044,15208,14516,11575,11290,9154,11458,8949,14079,15291,10878,8709,8232,12900,10193,15357,15323,9611,9766,10729,9439,15590,14678,8985,10653,8525,8204,12923,11576,9303,11217,11125,15633,10637,13876,8845,9971,14279,10212,12818,13960,13047,9411,14794,14053,14270,12966,9541,14184,13927,11853,8743,11679,13108,13474,11614,7869,9108,13569,9821,12986,14320,13822,10437,10626,12264,11182,12539,12075,7889,8595,11274,10420,11687,11997,15494,12531,9871,11204,14302,13474,10843,13143,10908,14641,9538,11815,11603,12596,15500,15642,9094,11720,14993,9318,8837,8045,13233,8495,12985,11482,11818,14327,11581,11262,15338,15530,12898,10763,8796,14387,10386,14477,9036,11320,8943,12376,11641,9513,12402,15336,7980,8262,11969,15347,8047,12324,8133,14369,10647,11144,9429,9213,10380,10700,14666,11443,14436,13031,14438,10361,14901,9046,13839,9073,12694,10249,8291,10985,12425,11641,14210,12120,12830,12692,12471,10426,14502,11538,9351,10571,14941,8856,11945,15191,11361,8073,14115,10567,15112,8138,15546,11559,10216,11707,11096,13024,8786,10101,9251,8524,11683,8291,8745,11997,15592,10056,14960,10434,14099,13467,9645,14099,8412,9564,14085,13425,9002,10237,11008,14531,8864,10592,8558,8896,8435,9993,13361,15132,8690,10153,15157,11358,12888,10264,11114,13260,13809,13528,10314,12889,8246,8043,12099,11834,9803,11463,12950,13067,9480,12092,11971,14530,9679,9859,11585,12615,9948,10443,12334,12087,13588,8246,15645,15579,14502,8039,8429,13303,10086,8491,8402,10124,11338,10981,12236,14215,15125,8546,9032,7890,13189,14849,15651,9670,14740,15711,15330,13507,14235,9462,10946,13452,9922,13769,9822,9034,10978,10617,15190,14290,13471,10679,8283,14924,9506,13666,12746,13265,8746,13918,11660,8700,8637,14172,15269,12858,9759,8220,12925,12657,10443,14986,11346,10018,11060,10418,11406,13879,14464,10482,10148,14577,13946,13317,11157,11701,11093,14258,10056,14545,11175,8978,13273,8450,12063,13445,8022,15198,8577,14654,11244,9594,12252,9070,14447,10861,15368,9769,12617,11061,13418,8936,14303,8373,11376,14087,10231,8337,15694,9766,15498,8513,15033,14701,12001,11998,8899,7972,11493,11176,10020,9978,12200,14863,8923,14094,9753,15328,12634,12039,8863,14708,15286,9890,12242,7906,8089,13513,9911,15293,11950,8888,8133,10147,9053,11715,10039,15593,15009,10252,15199,11355,13381,13952,12084,14992,14247,13851,8108,8481,11733,14865,12034,8979,13598,8343,8090,11760,7934,13696,15296,10954,12608,11294,8948,8838,10455,12877,12233,11652,13068,9731,8505,9223,8744,11257,9891,14308,10290,11353,8671,12561,11776,15347,9445,9224,7897,8006,13428,11556,8795,13770,11297,15624,14111,11635,9283,9832,8074,11532,15057,8189,8887,9205,8668,14426,8952,8919,15666,11349,14846,11579,10928,12269,8872,10738,10643,8282,14595,10045,11983,12086,13265,8447,10025,12658,12394,10017,13254,14888,11694,10833,11380,13261,15465,8785,9709,9805,13517,12107,15051,13264,11611,15663,10576,8289,10292,10186,14786,15524,9750,11857,15498,8837,15239,13353,11419,9239,13257,14795,14527,12067,11277,8869,10992,10127,13090,13314,8717,14939,10815,13205,13792,10973,14956,15146,8896,13138,14875,8792,14816,10670,14377,10501,11780,10374,12838,12713,9991,9222,13272,13226,13240,9042,12511,14436,8457,12451,9914,8710,12572,13781,9717,9196,15517,8010,11418,8416,13444,11270,11160,11344,7980,8109,14313,13153,9640,13199,13233,7874,10793,13532,8421,8952,9179,11278,11091,9428,11659,12981,15649,8894,8904,14208,13119,8748,11836,10784,15136,14029,11699,15515,9584,15134,8172,14030,12909,10534,12506,10491,13282,12634,9377,13288,11171,14496,12963,12177,7882,8533,14798,13217,14763,14697,15344,14118,9045,8017,14047,13891,13205,14448,14935,14862,15302,14597,15130,10797,15708,7942,15598,10679,13265,12010,9215,14320,14113,13397,11274,10106,11912,9305,11503,9394,9543,10755,8378,11674,9277,9654,8364,9812,11043,12693,14847,10937,12612,10304,12038,8617,15527,13041,8176,11125,7878,15474,11206,10436,13826,11449,15703,15210,10307,11436,9849,8203,8458,13327,15121,11500,12970,11586,10789,15701,9712,14652,15534,15411,10681,10588,9820,13427,8783,11873,10496,11694,10414,8960,11250,15599,11023,13981,15010,9495,11664,10046,13909,10935,10993,9126,13050,10945,8001,13804,12629,8684,14958,9314,9898,13419,12063,13000,10076,13325,8403,9489,8829,10090,14303,8541,11988,12195,9523,10436,10308,11324,12384,9337,8558,11984,13318,8606,15511,11364,12391,7964,12163,11321,11833,11225,14824,12582,12555,11874,9561,14126,15453,15153,12116,9117,14632,13846,15168,12572,10981,12974,10623,14043,12428,8938,12232,14830,13831,7931,8562,13139,12208,15113,12711,7965,11834,9095,9187,8211,14997,13025,8216,8785,12689,10854,14299,13973,9476,12149,8641,14965,13634,8148,13466,13053,13927,12895,10615,10356,13281,12299,14897,10086,14034,13321,10414,8200,11297,9333,11512,12812,9559,15265,12587,9456,12891,9009,10487,11193,15488,9169,14035,12717,14207,11277,15515,12978,13652,12352,14020,9734,10831,12125,8326,9998,10157,9774,13300,12773,9100,11938,14361,13592,14881,8767,14953,12355,9370,10090,13540,10784,15350,11880,9843,15101,8605,10724,12922,12247,11771,15406,13518,9403,15614,11844,15052,13442,8310,8671,14674,12728,9647,10211,14946,10787,13652,15677,15203,12649,12363,11409,15562,15640,13806,15424,14196,14252,14248,8553,13500,8931,10301,12990,10688,11574,13438,15559,11624,10284,9082,15388,12166,14593,13416,8642,9713,8326,12538,12719,12478,14864,8508,15330,13466,9252,15689,14012,12141,14718,13018,14875,12933,14939,14470,8361,12355,10047,9042))
{
	wanted.nodes <- c(getSisters(mytree, node=i, mode=c("number")))
	#wanted.names <- nn.to.name(mytree, wanted.tips)
	sister <- c(wanted.nodes)
	sister_list <- append(sister, sister_list)	
}	

write.table(sister_list, row.names=FALSE, quote=FALSE, col.names=FALSE, file="SisterNodes.txt")

##AFter the table with all the sister nodes is created, need to run through both sets of nodes to generate 2000 files with all the tips
#WGD nodes

mytree <- read.nexus("Angiosperm_MEDUSA_tree.nex")


for(i in c(10939,11033,9987,14865,15516,8853,12263,12352,9531,8918,11540,12586,7918,8873,7869,8771,11197,15659,13526,12913,11705,9720,13953,11121,10988,12322,13282,14039,8711,8221,10865,15379,11006,12861,12692,13431,11718,9588,12979,7893,15380,11899,14321,11453,14500,13255,11561,14784,9382,14936,8152,15281,12843,12412,8385,12869,11144,9912,11519,12949,8950,10791,8656,12614,14235,9038,12044,15208,14516,11575,11290,9154,11458,8949,14079,15291,10878,8709,8232,12900,10193,15357,15323,9611,9766,10729,9439,15590,14678,8985,10653,8525,8204,12923,11576,9303,11217,11125,15633,10637,13876,8845,9971,14279,10212,12818,13960,13047,9411,14794,14053,14270,12966,9541,14184,13927,11853,8743,11679,13108,13474,11614,7869,9108,13569,9821,12986,14320,13822,10437,10626,12264,11182,12539,12075,7889,8595,11274,10420,11687,11997,15494,12531,9871,11204,14302,13474,10843,13143,10908,14641,9538,11815,11603,12596,15500,15642,9094,11720,14993,9318,8837,8045,13233,8495,12985,11482,11818,14327,11581,11262,15338,15530,12898,10763,8796,14387,10386,14477,9036,11320,8943,12376,11641,9513,12402,15336,7980,8262,11969,15347,8047,12324,8133,14369,10647,11144,9429,9213,10380,10700,14666,11443,14436,13031,14438,10361,14901,9046,13839,9073,12694,10249,8291,10985,12425,11641,14210,12120,12830,12692,12471,10426,14502,11538,9351,10571,14941,8856,11945,15191,11361,8073,14115,10567,15112,8138,15546,11559,10216,11707,11096,13024,8786,10101,9251,8524,11683,8291,8745,11997,15592,10056,14960,10434,14099,13467,9645,14099,8412,9564,14085,13425,9002,10237,11008,14531,8864,10592,8558,8896,8435,9993,13361,15132,8690,10153,15157,11358,12888,10264,11114,13260,13809,13528,10314,12889,8246,8043,12099,11834,9803,11463,12950,13067,9480,12092,11971,14530,9679,9859,11585,12615,9948,10443,12334,12087,13588,8246,15645,15579,14502,8039,8429,13303,10086,8491,8402,10124,11338,10981,12236,14215,15125,8546,9032,7890,13189,14849,15651,9670,14740,15711,15330,13507,14235,9462,10946,13452,9922,13769,9822,9034,10978,10617,15190,14290,13471,10679,8283,14924,9506,13666,12746,13265,8746,13918,11660,8700,8637,14172,15269,12858,9759,8220,12925,12657,10443,14986,11346,10018,11060,10418,11406,13879,14464,10482,10148,14577,13946,13317,11157,11701,11093,14258,10056,14545,11175,8978,13273,8450,12063,13445,8022,15198,8577,14654,11244,9594,12252,9070,14447,10861,15368,9769,12617,11061,13418,8936,14303,8373,11376,14087,10231,8337,15694,9766,15498,8513,15033,14701,12001,11998,8899,7972,11493,11176,10020,9978,12200,14863,8923,14094,9753,15328,12634,12039,8863,14708,15286,9890,12242,7906,8089,13513,9911,15293,11950,8888,8133,10147,9053,11715,10039,15593,15009,10252,15199,11355,13381,13952,12084,14992,14247,13851,8108,8481,11733,14865,12034,8979,13598,8343,8090,11760,7934,13696,15296,10954,12608,11294,8948,8838,10455,12877,12233,11652,13068,9731,8505,9223,8744,11257,9891,14308,10290,11353,8671,12561,11776,15347,9445,9224,7897,8006,13428,11556,8795,13770,11297,15624,14111,11635,9283,9832,8074,11532,15057,8189,8887,9205,8668,14426,8952,8919,15666,11349,14846,11579,10928,12269,8872,10738,10643,8282,14595,10045,11983,12086,13265,8447,10025,12658,12394,10017,13254,14888,11694,10833,11380,13261,15465,8785,9709,9805,13517,12107,15051,13264,11611,15663,10576,8289,10292,10186,14786,15524,9750,11857,15498,8837,15239,13353,11419,9239,13257,14795,14527,12067,11277,8869,10992,10127,13090,13314,8717,14939,10815,13205,13792,10973,14956,15146,8896,13138,14875,8792,14816,10670,14377,10501,11780,10374,12838,12713,9991,9222,13272,13226,13240,9042,12511,14436,8457,12451,9914,8710,12572,13781,9717,9196,15517,8010,11418,8416,13444,11270,11160,11344,7980,8109,14313,13153,9640,13199,13233,7874,10793,13532,8421,8952,9179,11278,11091,9428,11659,12981,15649,8894,8904,14208,13119,8748,11836,10784,15136,14029,11699,15515,9584,15134,8172,14030,12909,10534,12506,10491,13282,12634,9377,13288,11171,14496,12963,12177,7882,8533,14798,13217,14763,14697,15344,14118,9045,8017,14047,13891,13205,14448,14935,14862,15302,14597,15130,10797,15708,7942,15598,10679,13265,12010,9215,14320,14113,13397,11274,10106,11912,9305,11503,9394,9543,10755,8378,11674,9277,9654,8364,9812,11043,12693,14847,10937,12612,10304,12038,8617,15527,13041,8176,11125,7878,15474,11206,10436,13826,11449,15703,15210,10307,11436,9849,8203,8458,13327,15121,11500,12970,11586,10789,15701,9712,14652,15534,15411,10681,10588,9820,13427,8783,11873,10496,11694,10414,8960,11250,15599,11023,13981,15010,9495,11664,10046,13909,10935,10993,9126,13050,10945,8001,13804,12629,8684,14958,9314,9898,13419,12063,13000,10076,13325,8403,9489,8829,10090,14303,8541,11988,12195,9523,10436,10308,11324,12384,9337,8558,11984,13318,8606,15511,11364,12391,7964,12163,11321,11833,11225,14824,12582,12555,11874,9561,14126,15453,15153,12116,9117,14632,13846,15168,12572,10981,12974,10623,14043,12428,8938,12232,14830,13831,7931,8562,13139,12208,15113,12711,7965,11834,9095,9187,8211,14997,13025,8216,8785,12689,10854,14299,13973,9476,12149,8641,14965,13634,8148,13466,13053,13927,12895,10615,10356,13281,12299,14897,10086,14034,13321,10414,8200,11297,9333,11512,12812,9559,15265,12587,9456,12891,9009,10487,11193,15488,9169,14035,12717,14207,11277,15515,12978,13652,12352,14020,9734,10831,12125,8326,9998,10157,9774,13300,12773,9100,11938,14361,13592,14881,8767,14953,12355,9370,10090,13540,10784,15350,11880,9843,15101,8605,10724,12922,12247,11771,15406,13518,9403,15614,11844,15052,13442,8310,8671,14674,12728,9647,10211,14946,10787,13652,15677,15203,12649,12363,11409,15562,15640,13806,15424,14196,14252,14248,8553,13500,8931,10301,12990,10688,11574,13438,15559,11624,10284,9082,15388,12166,14593,13416,8642,9713,8326,12538,12719,12478,14864,8508,15330,13466,9252,15689,14012,12141,14718,13018,14875,12933,14939,14470,8361,12355,10047,9042))
{
	wanted.tips <- getDescendants(mytree, node=i)
	wanted.names <- nn.to.name(mytree, wanted.tips)
	write.table(wanted.names, row.names=FALSE, quote=FALSE, col.names=FALSE, file=sprintf("%i.txt",i))
}	

#Sister nodes
#First had to reorder the nodes to be in the correct order of the WGD events
#x <- c(9044,10050,4492,499,6608,14940,12934,14874,5156,14720,4277,14013,7827,1389,13470,15319,644,6999,12479,4856,12539,8324,9719,8646,5555,6730,12169,15382,9084,2420,11626,15564,13451,3710,2824,5126,2436,8932,13499,8556,14247,14253,6333,15419,5944,7778,7700,11411,12364,4786,15097,7815,13655,10788,14949,10212,1785,12729,14683,8666,445,13444,15042,11841,15615,1540,13516,15407,11773,4384,12925,10731,739,15098,10065,11886,15349,10778,5677,10089,9371,4492,7092,904,14882,5729,14358,4074,9099,12775,5436,9777,10160,2136,8324,4262,2967,9735,14021,12354,13655,12976,15521,3412,14204,12714,14105,9151,7626,11195,2623,1146,5026,1593,4725,7402,9555,4948,3648,1470,11284,8193,10413,13320,14193,10083,7034,12296,5418,10354,10616,5033,6064,13052,13470,8143,5770,14966,8585,4285,9477,6109,6437,10853,12690,8782,353,13026,15005,8217,9183,1233,3970,7967,4850,7250,12202,13128,8570,7934,5969,14855,4368,8937,4566,14044,10432,12970,3116,12581,7313,5982,14633,9215,12115,15154,15450,6262,9562,4007,12549,4721,6960,3362,11839,11320,4300,7968,12396,3499,7649,8607,5456,11988,693,1474,12416,3461,10307,10467,9528,12199,11984,677,14307,10089,963,9491,538,5463,10073,5136,12058,5558,9890,9313,14956,8686,12623,13808,137,10941,13054,1263,10991,3070,6045,10040,3799,9496,15009,6121,11026,7737,11231,8958,10413,11693,10488,11875,918,13422,1955,2721,2817,15412,15535,14650,9710,7839,2926,11584,12974,11491,7257,13317,8445,338,9848,3572,10308,7349,7842,11426,5962,10467,11201,15473,17,11126,8175,5179,7665,8618,12041,10305,4749,10938,14854,12682,11038,9814,8438,9663,1415,3810,8380,10752,9540,1530,3638,1442,4049,2242,3410,5535,6252,6457,9117,4146,5404,2814,15601,79,15707,2934,15133,14587,7440,14859,14936,14449,13204,6027,6185,8016,1182,6255,7482,6834,6899,5354,14797,8531,21,12180,12951,6635,3307,13311,9378,12631,13283,2626,12505,2669,12908,6168,8167,15129,1720,15521,3834,14028,15135,10778,3976,886,13121,14213,8903,8885,15648,12982,3794,9422,11089,11275,9180,1088,573,13531,10794,13,13243,13201,9649,13152,14315,244,7975,11345,11159,11269,13442,8417,11421,8009,15516,9197,9718,13785,12581,8713,9916,4588,593,14434,12502,9044,5381,13224,5411,9271,2128,12705,12839,2509,3915,10499,14378,10669,6953,8795,14874,5277,1032,15147,14958,3110,13791,13204,10624,14940,8703,13315,13091,10102,3128,1005,3412,12068,6662,14794,13260,1375,3554,13385,7377,971,7633,3994,1889,7662,6923,2325,10293,8291,2712,7802,3748,13263,7189,12108,5654,9806,9701,8782,15467,13266,11369,10834,11693,7025,13251,2154,4531,4794,10011,8453,5404,12082,11992,2185,6731,417,10642,10735,1012,12271,10914,3715,14844,3484,15683,1056,1088,6563,8670,9206,8888,326,7195,3668,210,9830,9287,11634,6247,7762,11284,13766,8792,11559,13434,8004,33,1363,1581,15354,11777,4699,8666,11352,2424,6445,9893,11261,880,9225,8504,9729,13083,11651,12231,12876,10450,8834,1084,3430,12606,10955,15295,5833,7931,3895,8089,8094,13597,1116,12033,14858,11730,8477,8138,13863,14248,14993,4220,13953,5519,11356,7337,2388,15010,7732,10037,3855,9051,10144,8137,8887,11959,15292,2048,13514,8090,41,12241,9898,15280,14711,8864,4175,12631,15327,1891,6231,8911,7002,4338,2114,2157,11174,3628,7955,8901,4134,12002,14702,7170,8544,7633,1903,7833,8336,2369,14086,11374,8374,14307,8933,13417,3198,12622,1905,7506,2998,6585,9069,12253,1732,3380,6790,8576,15197,8810,5590,12058,585,13270,8982,3311,14544,10060,14257,11084,3837,11168,13327,6082,14509,10152,2618,14466,13882,3544,2554,11058,10019,11347,14985,2578,12660,12922,8233,9763,12853,15268,14173,8639,8702,3795,6054,8731,5404,4888,13665,1645,14814,418,2814,13473,14288,15189,10605,10977,1170,9818,13767,2062,13491,3082,9464,14234,13505,15319,7850,6876,1806,15596,6984,5327,7896,9028,683,7261,14218,12238,3116,11340,2261,8404,625,10083,5440,565,8040,6641,7717,15647,381,13590,4225,12336,2578,9949,4752,3720,9858,9681,6666,11974,12096,9482,13049,12948,11480,1940,3970,12100,8027,381,5032,2450,13530,13982,13257,11121,10263,12894,3494,15156,2291,827,7267,13359,2131,570,1032,693,10583,8863,14525,3144,10239,1138,13423,14084,1701,551,14097,9641,13468,14097,10433,14959,10060,15591,11996,881,8289,11681,8523,9250,10068,922,13028,11106,11706,2352,11556,7684,8108,15143,10563,6253,8072,11362,15201,4081,994,14945,10569,1488,3675,6641,10202,4608,12691,4967,12124,6346,11647,12426,3121,8289,2384,4832,8811,5974,9041,14887,10363,6575,5168,14434,11437,14659,10707,10381,9207,1568,11140,10649,6509,8137,4460,8046,15354,11962,397,7975,7475,12398,1650,11647,12368,1078,11321,9033,6615,10421,6525,8798,2900,12901,7668,15294,3397,3717,14324,11816,3619,5123,631,13243,8049,971,9315,14992,11729,9090,7781,15492,4735,3738,11821,1676,14635,10909,13140,2979,13484,14310,3339,9872,12440,7629,11996,11689,2556,3410,729,7888,4216,12538,11184,4400,10627,10445,13828,6457,12992,9819,13567,1245,7861,11598,13484,13104,11680,879,11856,6064,14181,1678,12965,14269,14049,14795,9410,5184,6096,4954,10211,14280,9974,8849,13878,10641,15634,11126,3353,1440,11565,5060,339,8527,2789,9004,6815,15589,9438,2864,1903,9610,7460,15363,10195,5036,366,8708,3015,15233,14082,1085,3594,9153,3425,3713,14532,15209,12050,1175,14234,12616,8655,2927,8951,5086,11521,9899,11140,5006,8384,12414,12845,15285,286,14935,9391,14785,11560,5393,14501,3589,14319,11898,15475,27,5119,9589,11862,13430,12691,12865,10995,15594,10864,8222,846,6175,13283,12331,10987,11114,13952,9724,11704,5049,5664,7798,11192,907,7861,1011,7919,4724,11541,8917,1669,12354,4399,988,15517,14858,2124,11031,10932)
#y <- rev(x)
#write.table(y,col.names=FALSE, row.names=FALSE, quote=FALSE, file="Correct_order_sister_nodes.txt")

#then find descendents
mytree <- read.nexus("Angiosperm_MEDUSA_tree.nex")


for(i in c(10932,11031,2124,14858,15517,988,4399,12354,1669,8917,11541,4724,7919,1011,7861,907,11192,7798,5664,5049,11704,9724,13952,11114,10987,12331,13283,6175,846,8222,10864,15594,10995,12865,12691,13430,11862,9589,5119,27,15475,11898,14319,3589,14501,5393,11560,14785,9391,14935,286,15285,12845,12414,8384,5006,11140,9899,11521,5086,8951,2927,8655,12616,14234,1175,12050,15209,14532,3713,3425,9153,3594,1085,14082,15233,3015,8708,366,5036,10195,15363,7460,9610,1903,2864,9438,15589,6815,9004,2789,8527,339,5060,11565,1440,3353,11126,15634,10641,13878,8849,9974,14280,10211,4954,6096,5184,9410,14795,14049,14269,12965,1678,14181,6064,11856,879,11680,13104,13484,11598,7861,1245,13567,9819,12992,6457,13828,10445,10627,4400,11184,12538,4216,7888,729,3410,2556,11689,11996,7629,12440,9872,3339,14310,13484,2979,13140,10909,14635,1676,11821,3738,4735,15492,7781,9090,11729,14992,9315,971,8049,13243,631,5123,3619,11816,14324,3717,3397,15294,7668,12901,2900,8798,6525,10421,6615,9033,11321,1078,12368,11647,1650,12398,7475,7975,397,11962,15354,8046,4460,8137,6509,10649,11140,1568,9207,10381,10707,14659,11437,14434,5168,6575,10363,14887,9041,5974,8811,4832,2384,8289,3121,12426,11647,6346,12124,4967,12691,4608,10202,6641,3675,1488,10569,14945,994,4081,15201,11362,8072,6253,10563,15143,8108,7684,11556,2352,11706,11106,13028,922,10068,9250,8523,11681,8289,881,11996,15591,10060,14959,10433,14097,13468,9641,14097,551,1701,14084,13423,1138,10239,3144,14525,8863,10583,693,1032,570,2131,13359,7267,827,2291,15156,3494,12894,10263,11121,13257,13982,13530,2450,5032,381,8027,12100,3970,1940,11480,12948,13049,9482,12096,11974,6666,9681,9858,3720,4752,9949,2578,12336,4225,13590,381,15647,7717,6641,8040,565,5440,10083,625,8404,2261,11340,3116,12238,14218,7261,683,9028,7896,5327,6984,15596,1806,6876,7850,15319,13505,14234,9464,3082,13491,2062,13767,9818,1170,10977,10605,15189,14288,13473,2814,418,14814,1645,13665,4888,5404,8731,6054,3795,8702,8639,14173,15268,12853,9763,8233,12922,12660,2578,14985,11347,10019,11058,2554,3544,13882,14466,2618,10152,14509,6082,13327,11168,3837,11084,14257,10060,14544,3311,8982,13270,585,12058,5590,8810,15197,8576,6790,3380,1732,12253,9069,6585,2998,7506,1905,12622,3198,13417,8933,14307,8374,11374,14086,2369,8336,7833,1903,7633,8544,7170,14702,12002,4134,8901,7955,3628,11174,2157,2114,4338,7002,8911,6231,1891,15327,12631,4175,8864,14711,15280,9898,12241,41,8090,13514,2048,15292,11959,8887,8137,10144,9051,3855,10037,7732,15010,2388,7337,11356,5519,13953,4220,14993,14248,13863,8138,8477,11730,14858,12033,1116,13597,8094,8089,3895,7931,5833,15295,10955,12606,3430,1084,8834,10450,12876,12231,11651,13083,9729,8504,9225,880,11261,9893,6445,2424,11352,8666,4699,11777,15354,1581,1363,33,8004,13434,11559,8792,13766,11284,7762,6247,11634,9287,9830,210,3668,7195,326,8888,9206,8670,6563,1088,1056,15683,3484,14844,3715,10914,12271,1012,10735,10642,417,6731,2185,11992,12082,5404,8453,10011,4794,4531,2154,13251,7025,11693,10834,11369,13266,15467,8782,9701,9806,5654,12108,7189,13263,3748,7802,2712,8291,10293,2325,6923,7662,1889,3994,7633,971,7377,13385,3554,1375,13260,14794,6662,12068,3412,1005,3128,10102,13091,13315,8703,14940,10624,13204,13791,3110,14958,15147,1032,5277,14874,8795,6953,10669,14378,10499,3915,2509,12839,12705,2128,9271,5411,13224,5381,9044,12502,14434,593,4588,9916,8713,12581,13785,9718,9197,15516,8009,11421,8417,13442,11269,11159,11345,7975,244,14315,13152,9649,13201,13243,13,10794,13531,573,1088,9180,11275,11089,9422,3794,12982,15648,8885,8903,14213,13121,886,3976,10778,15135,14028,3834,15521,1720,15129,8167,6168,12908,2669,12505,2626,13283,12631,9378,13311,3307,6635,12951,12180,21,8531,14797,5354,6899,6834,7482,6255,1182,8016,6185,6027,13204,14449,14936,14859,7440,14587,15133,2934,15707,79,15601,2814,5404,4146,9117,6457,6252,5535,3410,2242,4049,1442,3638,1530,9540,10752,8380,3810,1415,9663,8438,9814,11038,12682,14854,10938,4749,10305,12041,8618,7665,5179,8175,11126,17,15473,11201,10467,5962,11426,7842,7349,10308,3572,9848,338,8445,13317,7257,11491,12974,11584,2926,7839,9710,14650,15535,15412,2817,2721,1955,13422,918,11875,10488,11693,10413,8958,11231,7737,11026,6121,15009,9496,3799,10040,6045,3070,10991,1263,13054,10941,137,13808,12623,8686,14956,9313,9890,5558,12058,5136,10073,5463,538,9491,963,10089,14307,677,11984,12199,9528,10467,10307,3461,12416,1474,693,11988,5456,8607,7649,3499,12396,7968,4300,11320,11839,3362,6960,4721,12549,4007,9562,6262,15450,15154,12115,9215,14633,5982,7313,12581,3116,12970,10432,14044,4566,8937,4368,14855,5969,7934,8570,13128,12202,7250,4850,7967,3970,1233,9183,8217,15005,13026,353,8782,12690,10853,6437,6109,9477,4285,8585,14966,5770,8143,13470,13052,6064,5033,10616,10354,5418,12296,7034,10083,14193,13320,10413,8193,11284,1470,3648,4948,9555,7402,4725,1593,5026,1146,2623,11195,7626,9151,14105,12714,14204,3412,15521,12976,13655,12354,14021,9735,2967,4262,8324,2136,10160,9777,5436,12775,9099,4074,14358,5729,14882,904,7092,4492,9371,10089,5677,10778,15349,11886,10065,15098,739,10731,12925,4384,11773,15407,13516,1540,15615,11841,15042,13444,445,8666,14683,12729,1785,10212,14949,10788,13655,7815,15097,4786,12364,11411,7700,7778,5944,15419,6333,14253,14247,8556,13499,8932,2436,5126,2824,3710,13451,15564,11626,2420,9084,15382,12169,6730,5555,8646,9719,8324,12539,4856,12479,6999,644,15319,13470,1389,7827,14013,4277,14720,5156,14874,12934,14940,6608,499,4492,10050,9044))
{
	wanted.tips <- getDescendants(mytree, node=i)
	wanted.names <- nn.to.name(mytree, wanted.tips)
	write.table(wanted.names, row.names=FALSE, quote=FALSE, col.names=FALSE, file=sprintf("%i.txt",i))
}	

